<%= render 'shared/user_icon', css_class:"bi d-block mx-auto mb-4 rounded-circle" %>

<%= form_with model: @user, url: signup_path do |user_form| %>

  <%= user_form.fields_for :person do |person_form| %>

	  <%= tag.div class: "d-flex flex-wrap" do %>
		
			<%= tag.div class: "flex-fill me-2 mb-3" do %>
			
			  <%= render_form_field_for person_form, attribute: :first_name do %>
				
					<%= person_form.label :first_name, "First name*", class: "form-label" %>
				  
			    <%= render 'shared/errors/error_message', error_message: person_form.object.errors.messages[:first_name].first %>
			  
					<%= person_form.text_field :first_name, class: "form-control", required: true, autofocus: user_form.object.errors.empty? %>
					
				<% end %>

			<% end %>
			
			<%= tag.div class: "flex-fill me-2 mb-3" do %>
			
			  <%= render_form_field_for person_form, attribute: :last_name do %>
				
					<%= person_form.label :last_name, "Last name*", class: "form-label" %>
				  
			    <%= render 'shared/errors/error_message', error_message: person_form.object.errors.messages[:last_name].first %>
			  
					<%= person_form.text_field :last_name, class: "form-control", required: true, autofocus: false %>
					
				<% end %>

			<% end %>
			
		<% end %>


	  <%= tag.div class: "d-flex flex-wrap" do %>
		
			<%= tag.div class: "flex-fill me-2 mb-3" do %>
			
				  <%= render_form_field_for user_form, attribute: :username do %>
			
						<%= user_form.label :username, "Username*", class: "form-label" %>
			  
				    <%= render 'shared/errors/error_message', error_message: user_form.object.errors.messages[:username].first %>
		  
						<%= user_form.text_field :username, class: "form-control", required: true, autofocus: false %>
				
					<% end %>
	
			<% end %>

			<%= person_form.fields_for :email_addresses do |email_form| %>
			  
			  <% email_str_label = ( required = email_form.object.eql?(@user.person.email_addresses.first) ) ? "Email Address*"
				                                                                                               : "Email Address" %>
			
				<%= tag.div class: "flex-fill me-2 mb-3" do %>
				
				  <%= render_form_field_for email_form, attribute: :address do %>
		
						<%= email_form.label :address, email_str_label, class: "form-label" %>
		  
				    <%= render 'shared/errors/error_message', error_message: email_form.object.errors.messages[:address].first %>
	  
						<%= email_form.email_field :address, class: "form-control", required: required, autofocus: false %>
			
					<% end %>

				<% end %>
				
			<% end %>

		<% end %>
			
  <% end %> <!-- end of: user_form.fields_for :person ... -->
	

  <%= tag.div class: "d-flex flex-wrap" do %>
		
		<%= tag.div class: "flex-fill me-2 mb-3" do %>
		
		  <%= render_form_field_for user_form, attribute: :password do %>
			
				<%= user_form.label :password, "Password*", class: "form-label" %>
			  
		    <%= render 'shared/errors/error_message', error_message: user_form.object.errors.messages[:password].first %>
		  
				<%= user_form.password_field :password, class: "form-control", required: true, autofocus: false %>
				
			<% end %>
			
		<% end %>
		
		<%= tag.div class: "flex-fill me-2 mb-3" do %>
		
		  <%= render_form_field_for user_form, attribute: :password_confirmation do %>
			
				<%= user_form.label :password_confirmation, "Confirmation*", class: "form-label" %>
			  
		    <%= render 'shared/errors/error_message', error_message: user_form.object.errors.messages[:password_confirmation].first %>
		  
				<%= user_form.password_field :password_confirmation, class: "form-control", required: true, autofocus: false %>
				
			<% end %>
	
		<% end %>
		
	<% end %>
			
  <%= tag.div class: "actions center py-3" do %>
		<%= user_form.submit "Sign up", class: "btn btn-primary w-100"  %>
	<% end %>	

			
<% end %>
